{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '47542274-6332373665e9da78801fe67b7';\nconst BASE_URL = 'https://pixabay.com/api/';\nconst PER_PAGE = 15; // По заданию \n\nexport async function fetchImages(query, page = 1) {\n  const url = `${BASE_URL}?key=${API_KEY}&q=${query}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=${PER_PAGE}`;\n\n  try {\n    const { data } = await axios.get(url);\n    return data; \n  } catch (error) {\n    console.error('Error fetching images:', error.message);\n    throw error;\n  }\n}","export function displayImages(images, galleryElement, lightbox) {\n  galleryElement.innerHTML = ''; // Очищення галереї перед додаванням нових зображень\n\n  if (images.hits.length === 0) {\n    iziToast.info({\n      title: 'Info',\n      message: 'Sorry, there are no images matching your search query. Please try again!',\n    });\n    return;\n  }\n\n  const markup = images.hits\n    .map(\n      (image) => `\n      <div class=\"gallery-item\">\n        <a href=\"${image.largeImageURL}\">\n          <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" class=\"gallery-image\" />\n        </a>\n        <div class=\"image-info\">\n        <p><strong>Tags:</strong> ${image.tags}</p>\n          <p>Likes: ${image.likes}</p>\n          <p>Views: ${image.views}</p>\n          <p>Comments: ${image.comments}</p>\n          <p>Downloads: ${image.downloads}</p>\n        </div>\n      </div>\n    `\n    )\n    .join('');\n\n  galleryElement.insertAdjacentHTML('beforeend', markup);\n\n  // Оновлення lightbox\n  setTimeout(() => {\n    lightbox.refresh();\n  }, 0);\n}\n\n\n ","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport './css/styles.css';\nimport { fetchImages as pixabayFetchImages } from './js/pixabay-api.js'; // Импорт API-запросов\nimport { displayImages } from './js/render-functions.js';\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nconst searchForm = document.getElementById('search-form');\nconst gallery = document.getElementById('gallery');\nconst loader = document.getElementById('loader');\nconst loadMoreBtn = document.getElementById('load-more');\nconst endMessage = document.getElementById('end-message'); // Для сообщения о конце результатов\n\nlet query = '';\nlet page = 1;\nlet totalHits = 0; // Общее количество изображений для данного поиска\n\n// для управления загрузчиком\nfunction showLoader() {\n  loader.style.display = 'block';\n}\n\nfunction hideLoader() {\n  loader.style.display = 'none';\n}\n\n// для загрузки изображений\nasync function fetchImages(query, page) {\n  try {\n    showLoader();\n    const response = await pixabayFetchImages(query, page, 15);\n    return response;\n  } catch (error) {\n    console.error('Error fetching images:', error);\n    throw error;\n  } finally {\n    hideLoader();\n  }\n}\n\n// для отображения кнопки лоад мор\nfunction toggleLoadMoreButton(show) {\n  if (show) {\n    loadMoreBtn.style.display = 'block';\n  } else {\n    loadMoreBtn.style.display = 'none';\n  }\n}\n\n// для отображения сообщения о конце результатов\nfunction showEndMessage() {\n  endMessage.textContent = \"We're sorry, but you've reached the end of search results.\";\n  endMessage.style.display = 'block';\n}\n\n// Обработчик сабмита формы\nsearchForm.addEventListener('submit', async (event) => {\n  event.preventDefault();\n  query = searchForm.elements.query.value.trim();\n\n  if (!query) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Please enter a search term.',\n    });\n    return;\n  }\n\n  // Очистка галереи и сброс страницы\n  gallery.innerHTML = '';\n  page = 1;\n  totalHits = 0; // Сбрасываем общее количество изображений\n  toggleLoadMoreButton(false);\n  endMessage.style.display = 'none'; // Скрываем сообщение о конце\n\n  try {\n    const images = await fetchImages(query, page);\n    totalHits = images.totalHits; // Обновляем общее количество изображений\n    displayImages(images, gallery, lightbox);\n    lightbox.refresh();\n    toggleLoadMoreButton(images.hits.length === 15); // Показываем кнопку, если есть больше изображений\n\n    // Если количество загруженных изображений меньше 15 или достигнут конец коллекции\n    if (images.hits.length < 15 || page * 15 >= totalHits) {\n      toggleLoadMoreButton(false); // Скрыть кнопку\n      showEndMessage(); // Показать сообщение о конце\n    }\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Failed to fetch images.',\n    });\n  }\n});\n\n// Обработчик кнопки лоад мор\nloadMoreBtn.addEventListener('click', async () => {\n  page += 1;\n\n  try {\n    const images = await fetchImages(query, page);\n    displayImages(images, gallery, lightbox);\n    lightbox.refresh();\n\n    \n\n    // Если изображений < 15, скрыть кнопку\n    if (images.hits.length < 15 || page * 15 >= totalHits) {\n      toggleLoadMoreButton(false); // Если достигнут конец коллекции\n      showEndMessage(); // Показать сообщение о конце\n    }\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Failed to fetch more images.',\n    });\n  }\n});\n"],"names":["API_KEY","BASE_URL","PER_PAGE","fetchImages","query","page","url","data","axios","error","displayImages","images","galleryElement","lightbox","markup","image","SimpleLightbox","searchForm","gallery","loader","loadMoreBtn","endMessage","totalHits","showLoader","hideLoader","pixabayFetchImages","toggleLoadMoreButton","show","showEndMessage","event","iziToast"],"mappings":"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"}